# 实现MCP日志展示功能

## 1. 需求分析

用户希望展示我们之前实现的MCP日志功能，包括：
1. 单独的MCP日志文件内容
2. 方法调用统计数据
3. 通过HTTP端点访问日志信息

## 2. 实现方案

### 2.1 日志数据获取模块

创建新文件 `doris_mcp_server/utils/mcp_log_reader.py`，实现日志文件读取和解析功能：
- 读取MCP日志文件（logs/doris_mcp_server_mcp.log）
- 解析日志条目，支持按时间范围、方法名筛选
- 提供方法调用统计数据访问接口

### 2.2 日志展示HTML模板

创建新文件 `doris_mcp_server/templates/mcp_log_templates.py`，包含日志展示页面：
- 日志列表展示，支持分页、搜索、筛选
- 方法调用统计图表
- 每日调用次数统计

### 2.3 日志管理HTTP处理器

创建新文件 `doris_mcp_server/auth/mcp_log_handlers.py`，实现HTTP端点：
- `/mcp/logs` - 获取日志列表
- `/mcp/logs/stats` - 获取调用统计数据
- `/mcp/logs/management` - 日志管理页面

### 2.4 集成到主服务器

修改 `doris_mcp_server/main.py`：
- 导入MCP日志处理器
- 添加日志管理HTTP路由

## 3. 实现步骤

1. 创建 `mcp_log_reader.py`，实现日志读取和解析功能
2. 创建 `mcp_log_templates.py`，设计日志展示HTML模板
3. 创建 `mcp_log_handlers.py`，实现日志管理HTTP端点
4. 修改 `main.py`，添加日志管理路由
5. 测试日志展示功能

## 4. 文件修改清单

- `doris_mcp_server/utils/mcp_log_reader.py` - 日志读取和解析模块
- `doris_mcp_server/templates/mcp_log_templates.py` - 日志展示HTML模板
- `doris_mcp_server/auth/mcp_log_handlers.py` - 日志管理HTTP处理器
- `doris_mcp_server/main.py` - 添加日志管理路由

## 5. 预期效果

- 访问 `/mcp/logs/management` 可以查看MCP日志管理页面
- 页面展示日志列表，支持搜索、筛选、分页
- 展示方法调用统计图表和每日调用次数
- 支持查看指定时间范围的日志